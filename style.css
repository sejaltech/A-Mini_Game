:root {
  --bg:        #050a0e;
  --panel:     #0c141a;
  --wall:      #0d2233;
  --wall-glow: #0a3d5c;
  --path:      #071520;
  --accent:    #00e5ff;
  --accent2:   #ff3cac;
  --accent3:   #ffe033;
  --text:      #c8e6f0;
  --text-dim:  #4a7a8a;
  --player-c:  #00e5ff;
  --goal-c:    #ffe033;
  --danger-c:  #ff3cac;

  --cell-size:  clamp(28px, 4.5vw, 52px);
  --wall-thick: 3px;
  --border-r:   4px;

  --font-display: 'Bebas Neue', sans-serif;
  --font-mono:    'Space Mono', monospace;
  --font-retro:   'VT323', monospace;

  --trans-fast:   0.12s ease;
  --trans-med:    0.3s ease;
  --trans-slow:   0.6s cubic-bezier(0.23, 1, 0.32, 1);
}

/* ── Reset ── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html, body { width: 100%; height: 100%; overflow: hidden; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: var(--font-mono);
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ── Screen System ── */
.screen {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transform: translateY(20px) scale(0.98);
  transition: opacity var(--trans-slow), transform var(--trans-slow);
  z-index: 10;
}
.screen.active {
  opacity: 1;
  pointer-events: all;
  transform: translateY(0) scale(1);
}
.screen.exit {
  opacity: 0;
  transform: translateY(-20px) scale(1.02);
}


.scanlines {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 100;
  background: repeating-linear-gradient(
    to bottom,
    transparent 0,
    transparent 3px,
    rgba(0,0,0,0.15) 3px,
    rgba(0,0,0,0.15) 4px
  );
  animation: scanMove 8s linear infinite;
}
@keyframes scanMove {
  from { background-position: 0 0; }
  to   { background-position: 0 200px; }
}

.grid-bg {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image:
    linear-gradient(rgba(0,229,255,0.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,229,255,0.04) 1px, transparent 1px);
  background-size: 40px 40px;
  animation: gridPulse 4s ease-in-out infinite;
}
@keyframes gridPulse {
  0%, 100% { opacity: 0.6; }
  50%       { opacity: 1; }
}

/* ── Corner Decorations ── */
.corner {
  position: absolute;
  width: 24px;
  height: 24px;
  border-color: var(--accent);
  border-style: solid;
  border-width: 0;
  animation: cornerPulse 2s ease-in-out infinite;
}
.corner-tl { top: 20px;    left: 20px;    border-top-width: 2px;    border-left-width: 2px; }
.corner-tr { top: 20px;    right: 20px;   border-top-width: 2px;    border-right-width: 2px; }
.corner-bl { bottom: 20px; left: 20px;    border-bottom-width: 2px; border-left-width: 2px; }
.corner-br { bottom: 20px; right: 20px;   border-bottom-width: 2px; border-right-width: 2px; }
@keyframes cornerPulse {
  0%, 100% { opacity: 0.5; }
  50%       { opacity: 1; box-shadow: 0 0 8px var(--accent); }
}

.start-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 36px;
  position: relative;
  z-index: 1;
  padding: 20px;
}

.logo-wrap { text-align: center; }
.logo-glitch {
  font-family: var(--font-display);
  font-size: clamp(52px, 10vw, 100px);
  color: var(--accent);
  position: relative;
  letter-spacing: 0.08em;
  text-shadow:
    0 0 20px rgba(0,229,255,0.8),
    0 0 60px rgba(0,229,255,0.4);
  animation: glitchText 5s ease-in-out infinite;
}
.logo-glitch::before,
.logo-glitch::after {
  content: attr(data-text);
  position: absolute;
  inset: 0;
  opacity: 0.8;
}
.logo-glitch::before {
  color: var(--accent2);
  animation: glitchBefore 5s ease-in-out infinite;
  clip-path: polygon(0 0, 100% 0, 100% 35%, 0 35%);
}
.logo-glitch::after {
  color: var(--accent3);
  animation: glitchAfter 5s ease-in-out infinite;
  clip-path: polygon(0 65%, 100% 65%, 100% 100%, 0 100%);
}
@keyframes glitchText {
  0%, 85%, 100% { transform: none; }
  87%  { transform: skewX(-3deg) translateX(4px); }
  89%  { transform: skewX(2deg) translateX(-4px); }
  91%  { transform: none; }
  93%  { transform: skewX(-1deg) translateX(2px); }
}
@keyframes glitchBefore {
  0%, 85%, 100% { transform: none; opacity: 0; }
  87%  { transform: translateX(-4px); opacity: 0.8; }
  89%  { transform: translateX(4px); opacity: 0.8; }
  91%  { transform: none; opacity: 0; }
}
@keyframes glitchAfter {
  0%, 85%, 100% { transform: none; opacity: 0; }
  87%  { transform: translateX(4px); opacity: 0.8; }
  89%  { transform: translateX(-4px); opacity: 0.8; }
  91%  { transform: none; opacity: 0; }
}
.logo-sub {
  font-family: var(--font-retro);
  font-size: 1.4rem;
  color: var(--text-dim);
  letter-spacing: 0.25em;
  margin-top: 4px;
  animation: fadeInUp 1s 0.5s both;
}

.start-info {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
  justify-content: center;
  animation: fadeInUp 1s 0.7s both;
}
.info-card {
  display: flex;
  align-items: center;
  gap: 10px;
  background: var(--panel);
  border: 1px solid rgba(0,229,255,0.15);
  border-radius: var(--border-r);
  padding: 10px 16px;
  font-size: 0.75rem;
  color: var(--text-dim);
  transition: border-color var(--trans-med), color var(--trans-med);
}
.info-card:hover {
  border-color: var(--accent);
  color: var(--text);
}
.info-icon { font-size: 1.1rem; }

.difficulty-select { text-align: center; animation: fadeInUp 1s 0.9s both; }
.select-label {
  font-family: var(--font-retro);
  font-size: 1rem;
  color: var(--text-dim);
  letter-spacing: 0.2em;
  margin-bottom: 12px;
}
.diff-buttons {
  display: flex;
  gap: 10px;
  justify-content: center;
}
.diff-btn {
  font-family: var(--font-mono);
  font-size: 0.8rem;
  font-weight: 700;
  padding: 8px 22px;
  border: 2px solid var(--text-dim);
  background: transparent;
  color: var(--text-dim);
  cursor: pointer;
  border-radius: var(--border-r);
  letter-spacing: 0.1em;
  transition: all var(--trans-med);
  position: relative;
  overflow: hidden;
}
.diff-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--accent);
  transform: scaleX(0);
  transform-origin: left;
  transition: transform var(--trans-med);
  z-index: -1;
}
.diff-btn:hover, .diff-btn.active {
  border-color: var(--accent);
  color: var(--bg);
}
.diff-btn:hover::before, .diff-btn.active::before { transform: scaleX(1); }

.cta-btn {
  font-family: var(--font-display);
  font-size: clamp(1.1rem, 2.5vw, 1.5rem);
  letter-spacing: 0.12em;
  padding: 14px 48px;
  border: 2px solid var(--accent);
  background: transparent;
  color: var(--accent);
  cursor: pointer;
  border-radius: var(--border-r);
  display: flex;
  align-items: center;
  gap: 12px;
  transition: all var(--trans-med);
  position: relative;
  overflow: hidden;
  animation: fadeInUp 1s 1.1s both;
}
.cta-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--accent);
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.3s ease;
  z-index: -1;
}
.cta-btn:hover {
  color: var(--bg);
  box-shadow: 0 0 30px rgba(0,229,255,0.5);
}
.cta-btn:hover::before { transform: scaleX(1); }
.cta-btn.ghost {
  border-color: var(--text-dim);
  color: var(--text-dim);
}
.cta-btn.ghost::before { background: var(--text-dim); }
.cta-btn.ghost:hover { color: var(--bg); }
.cta-btn.small { font-size: 1rem; padding: 10px 32px; }
.cta-arrow { font-size: 1.4rem; transition: transform var(--trans-fast); }
.cta-btn:hover .cta-arrow { transform: translateX(6px); }

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(16px); }
  to   { opacity: 1; transform: translateY(0); }
}


#game-screen {
  justify-content: space-between;
  padding: 0;
}


.hud {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 24px;
  background: var(--panel);
  border-bottom: 1px solid rgba(0,229,255,0.1);
  position: relative;
  z-index: 10;
  flex-shrink: 0;
}
.hud-block {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  min-width: 80px;
}
.hud-label {
  font-family: var(--font-retro);
  font-size: 0.85rem;
  color: var(--text-dim);
  letter-spacing: 0.15em;
}
.hud-value {
  font-family: var(--font-display);
  font-size: 2rem;
  color: var(--accent);
  line-height: 1;
  transition: transform 0.1s, color 0.2s;
}
.hud-value.pop { animation: valuePop 0.25s ease; }
@keyframes valuePop {
  0%   { transform: scale(1); }
  50%  { transform: scale(1.3); color: var(--accent3); }
  100% { transform: scale(1); }
}
.hud-center { flex: 1; max-width: 400px; }
.progress-wrap {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
}
.progress-bar-bg {
  width: 100%;
  height: 6px;
  background: rgba(0,229,255,0.1);
  border-radius: 3px;
  overflow: hidden;
}
.progress-bar-fill {
  height: 100%;
  width: 100%;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  border-radius: 3px;
  transform-origin: left;
  transition: width 1s linear;
  position: relative;
}
.progress-bar-fill::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
  animation: shimmer 2s linear infinite;
}
@keyframes shimmer {
  from { transform: translateX(-100%); }
  to   { transform: translateX(100%); }
}
.progress-bar-fill.danger {
  background: linear-gradient(90deg, var(--danger-c), #ff7b00);
  animation: dangerPulse 0.5s ease-in-out infinite;
}
@keyframes dangerPulse {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0.6; }
}
.hud-timer {
  font-family: var(--font-display);
  font-size: 1.8rem;
  color: var(--accent);
  transition: color 0.3s;
}
.hud-timer.danger { color: var(--danger-c); }

/* Game Area */
.game-area {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  overflow: hidden;
  position: relative;
}

/* Maze Container */
.maze-container {
  display: grid;
  position: relative;
  gap: 0;
  /* rows/cols set by JS */
  border: 2px solid rgba(0,229,255,0.2);
  box-shadow:
    0 0 40px rgba(0,229,255,0.1),
    inset 0 0 40px rgba(0,0,0,0.5);
  border-radius: 2px;
}

/* Maze Cells */
.cell {
  width: var(--cell-size);
  height: var(--cell-size);
  background: var(--path);
  position: relative;
  transition: background 0.2s;
}
.cell.wall {
  background: var(--wall);
  box-shadow: inset 0 0 8px rgba(0, 180, 220, 0.05);
}
.cell.wall::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(0,100,150,0.2) 0%, transparent 50%, rgba(0,50,100,0.1) 100%);
}

.cell.path {
  background: var(--path);
}
.cell.path::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, rgba(0,229,255,0.03), transparent);
}

.cell.visited::after {
  content: '';
  position: absolute;
  inset: 3px;
  background: rgba(0,229,255,0.04);
  border-radius: 1px;
}

.cell.player {
  background: var(--path);
  z-index: 5;
}
.cell.player::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle, rgba(0,229,255,0.3) 0%, transparent 70%);
  animation: playerGlow 1s ease-in-out infinite;
}
.cell.player::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 55%;
  height: 55%;
  transform: translate(-50%, -50%);
  background: var(--player-c);
  border-radius: 50%;
  box-shadow:
    0 0 10px var(--player-c),
    0 0 25px rgba(0,229,255,0.5);
  animation: playerPulse 1.5s ease-in-out infinite;
  z-index: 6;
}
@keyframes playerGlow {
  0%, 100% { opacity: 0.6; transform: scale(1); }
  50%       { opacity: 1;   transform: scale(1.1); }
}
@keyframes playerPulse {
  0%, 100% { transform: translate(-50%, -50%) scale(1); }
  50%       { transform: translate(-50%, -50%) scale(1.15); }
}

.cell.player-enter {
  animation: playerEnter 0.15s ease;
}
@keyframes playerEnter {
  from { background: rgba(0,229,255,0.3); }
  to   { background: var(--path); }
}


.cell.goal {
  background: var(--path);
  z-index: 4;
}
.cell.goal::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle, rgba(255,224,51,0.25) 0%, transparent 70%);
  animation: goalGlow 1.2s ease-in-out infinite alternate;
}
.cell.goal::after {
  content: '★';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: var(--goal-c);
  font-size: calc(var(--cell-size) * 0.55);
  line-height: 1;
  text-shadow: 0 0 12px var(--goal-c), 0 0 30px rgba(255,224,51,0.6);
  animation: goalSpin 4s linear infinite;
  z-index: 5;
}
@keyframes goalGlow {
  from { opacity: 0.6; }
  to   { opacity: 1; }
}
@keyframes goalSpin {
  from { transform: translate(-50%, -50%) rotate(0deg); }
  to   { transform: translate(-50%, -50%) rotate(360deg); }
}

.game-footer {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  padding: 10px 24px;
  background: var(--panel);
  border-top: 1px solid rgba(0,229,255,0.1);
  flex-shrink: 0;
}
.key-hints {
  display: flex;
  align-items: center;
  gap: 6px;
}
kbd {
  font-family: var(--font-mono);
  font-size: 0.65rem;
  padding: 3px 7px;
  border: 1px solid rgba(0,229,255,0.3);
  border-radius: 3px;
  background: rgba(0,229,255,0.05);
  color: var(--text-dim);
}
.key-sep { font-size: 0.7rem; color: var(--text-dim); margin: 0 4px; }
.pause-btn {
  font-family: var(--font-mono);
  font-size: 0.7rem;
  padding: 5px 14px;
  border: 1px solid rgba(0,229,255,0.2);
  background: transparent;
  color: var(--text-dim);
  cursor: pointer;
  border-radius: var(--border-r);
  transition: all var(--trans-med);
  letter-spacing: 0.05em;
}
.pause-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.pause-overlay {
  position: absolute;
  inset: 0;
  background: rgba(5,10,14,0.9);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 50;
  transition: opacity var(--trans-med);
}
.pause-overlay.hidden {
  opacity: 0;
  pointer-events: none;
}
.pause-box {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
  padding: 40px;
  border: 1px solid rgba(0,229,255,0.2);
  border-radius: var(--border-r);
  background: var(--panel);
}
.pause-title {
  font-family: var(--font-display);
  font-size: 3rem;
  color: var(--accent);
  letter-spacing: 0.15em;
  text-shadow: 0 0 20px rgba(0,229,255,0.5);
}

.gameover-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 28px;
  position: relative;
  z-index: 1;
  padding: 20px;
  max-width: 500px;
  width: 100%;
}

.result-badge {
  width: 90px;
  height: 90px;
  border-radius: 50%;
  border: 3px solid var(--accent);
  display: flex;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle, rgba(0,229,255,0.2), transparent);
  box-shadow: 0 0 30px rgba(0,229,255,0.4);
  animation: badgePop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) both;
}
.result-badge.fail {
  border-color: var(--danger-c);
  background: radial-gradient(circle, rgba(255,60,172,0.2), transparent);
  box-shadow: 0 0 30px rgba(255,60,172,0.4);
}
@keyframes badgePop {
  from { transform: scale(0); opacity: 0; }
  to   { transform: scale(1); opacity: 1; }
}
.result-icon {
  font-size: 2.5rem;
  color: var(--accent);
}
.result-badge.fail .result-icon { color: var(--danger-c); }

.result-title {
  font-family: var(--font-display);
  font-size: clamp(2.5rem, 7vw, 4.5rem);
  color: var(--accent);
  letter-spacing: 0.1em;
  text-shadow: 0 0 30px rgba(0,229,255,0.5);
  animation: fadeInUp 0.5s 0.3s both;
}
.result-title.fail {
  color: var(--danger-c);
  text-shadow: 0 0 30px rgba(255,60,172,0.5);
}
.result-sub {
  font-family: var(--font-retro);
  font-size: 1.2rem;
  color: var(--text-dim);
  letter-spacing: 0.15em;
  animation: fadeInUp 0.5s 0.4s both;
}

/* Scoreboard */
.scoreboard {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 2px;
  animation: fadeInUp 0.5s 0.5s both;
}
.score-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 20px;
  background: var(--panel);
  border: 1px solid rgba(0,229,255,0.08);
  border-radius: var(--border-r);
  transition: border-color var(--trans-med);
}
.score-row:hover { border-color: rgba(0,229,255,0.25); }
.score-row.highlight {
  background: rgba(0,229,255,0.07);
  border-color: rgba(0,229,255,0.25);
}
.score-key {
  font-family: var(--font-retro);
  font-size: 1rem;
  color: var(--text-dim);
  letter-spacing: 0.1em;
}
.score-val {
  font-family: var(--font-display);
  font-size: 1.5rem;
  color: var(--accent);
}
.score-row.highlight .score-val {
  color: var(--accent3);
  text-shadow: 0 0 10px rgba(255,224,51,0.5);
}

.highscore-wrap {
  display: flex;
  align-items: center;
  gap: 16px;
  animation: fadeInUp 0.5s 0.65s both;
}
.hs-label {
  font-family: var(--font-retro);
  font-size: 1rem;
  color: var(--text-dim);
  letter-spacing: 0.1em;
}
.hs-value {
  font-family: var(--font-display);
  font-size: 1.8rem;
  color: var(--accent3);
  text-shadow: 0 0 12px rgba(255,224,51,0.4);
}

.gameover-actions {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
  justify-content: center;
  animation: fadeInUp 0.5s 0.75s both;
}

.cell.wall-h-top::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 2px;
  background: var(--accent);
  box-shadow: 0 0 6px var(--accent);
  z-index: 3;
}
.cell.wall-h-bot::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 2px;
  background: var(--accent);
  box-shadow: 0 0 6px var(--accent);
  z-index: 3;
}

.confetti {
  position: fixed;
  top: -10px;
  width: 8px;
  height: 8px;
  border-radius: 2px;
  pointer-events: none;
  z-index: 200;
  animation: confettiFall linear forwards;
}
@keyframes confettiFall {
  to {
    transform: translateY(110vh) rotate(720deg);
    opacity: 0;
  }
}

@media (max-width: 600px) {
  :root { --cell-size: clamp(22px, 6vw, 36px); }

  .hud { padding: 8px 12px; }
  .hud-value { font-size: 1.5rem; }
  .hud-timer { font-size: 1.4rem; }

  .start-content { gap: 24px; }
  .start-info { flex-direction: column; align-items: center; }
  .info-card { font-size: 0.7rem; }

  .key-hints { display: none; }

  .gameover-content { gap: 18px; }
  .gameover-actions { flex-direction: column; }
  .cta-btn { justify-content: center; width: 100%; }

  .corner { display: none; }
}

@media (max-width: 400px) {
  :root { --cell-size: 20px; }
  .hud-block.hud-moves,
  .hud-block.hud-score { min-width: 60px; }
  .hud-value { font-size: 1.2rem; }
}

@media (min-width: 1200px) {
  :root { --cell-size: 52px; }
}

.shake {
  animation: shake 0.3s ease;
}
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20%       { transform: translateX(-4px); }
  40%       { transform: translateX(4px); }
  60%       { transform: translateX(-3px); }
  80%       { transform: translateX(3px); }
}

.flash-win {
  animation: flashWin 0.4s ease;
}
@keyframes flashWin {
  0%   { background: var(--path); }
  50%  { background: rgba(255,224,51,0.5); }
  100% { background: var(--path); }
}

button:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 3px;
}